<apex:page controller="PartnerPerformanceDashboardController" showHeader="false">

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load("visualization", "1", {packages:["columnchart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart(){
    var data = new google.visualization.DataTable();
    data.addColumn('string', 'Probability %');
    data.addColumn('number', 'Open');
    data.addColumn('number', 'Abandoned');
    data.addRows(9);    
    
    var stageValues = new Array(9);
    stageValues[0] = '12%';
    stageValues[1] = '20%';
    stageValues[2] = '25%';
    stageValues[3] = '50%';
    stageValues[4] = '60%';    
    stageValues[5] = '75%';    
    stageValues[6] = '85%';    
    stageValues[7] = '90%';    
    stageValues[8] = '95%';                
        
    //get all open opportunity sum list
    var sumOpenOpp = {!lstSumAmountOpenOpp};    
    
    //get all abandoned opportunity sum list
    var sumAbnOpp = {!lstSumAmountAbandonedOpp};     
    
    var x = 0;
    var y = 0;
    for(var iter = 0; iter < 9; iter++ ){
      y = 0;
      data.setValue(x, y, stageValues[iter]);
      data.setValue(x, y+1, sumOpenOpp[iter]); 
      data.setValue(x, y+2, sumAbnOpp[iter]);      
      x++;      
    }    
    var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
    chart.draw(data, {width: 300, height: 300, is3D: false, enableTooltip: false ,titleX: 'Probability %', titleY: 'Sum Of Amount in USD (Thousands)', isStacked: false, legend: 'bottom', title: 'Opportunity Pipeline By Probability', legendBackgroundColor: '#F8F8F8'});
  }  
  
</script>

<apex:form id="frmOpp">

  <apex:panelGrid columns="3">
    <apex:pageBlock title="Top 5 Opportunites">
      <apex:pageBlockTable value="{!lstTopOpportunities}" var="eachOppty">
        <apex:column headerValue="Name">
          <apex:outputLink value="/{!eachOppty.Id}" target="_blank">{!eachOppty.Name}</apex:outputLink>
        </apex:column>        
        <apex:column headerValue="Amount" value="{!eachOppty.Amount}"/>
      </apex:pageBlockTable>
    </apex:pageBlock>  
     
    <apex:pageBlock title="Abandoned Opportunites">
      <apex:pageBlockTable value="{!lstTopAbandonedOpportunities}" var="eachOppty">
        <apex:column headerValue="Name">
          <apex:outputLink value="/{!eachOppty.Id}" target="_blank">{!eachOppty.Name}</apex:outputLink>
        </apex:column>
        <apex:column headerValue="Amount"  value="{!eachOppty.Amount}"/>  
      </apex:pageBlockTable>
    </apex:pageBlock>
     
    <div id="chart_div"></div>      
  </apex:panelGrid>
     
</apex:form>
</apex:page>