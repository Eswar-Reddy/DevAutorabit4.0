<apex:page standardController="Opportunity" extensions="OpportunityScoreRelatedListController" id="pg" Rendered="{!IF(validOppty,true,false)}"> 
 <script src="https://code.jquery.com/jquery-2.1.4.min.js" />
    <style type="text/css">
        .center {  
            margin: 5px;
            border:5px solid black;   
            padding: 5px;    
        }    
    </style>    
   <apex:form id="frm" >     
    <apex:pageBlock id="pb1">
       <apex:pageMessages ></apex:pageMessages>  
        <apex:pageBlockButtons location="top" >
            <apex:commandButton value="New Score"  rendered="{! IF(newExistingButton == 'New', true, false)}" onclick="OpenVfpageConfrim()"/>  
            <apex:commandButton value="View Score" rendered="{! IF(newExistingButton == 'Existing', true, false)}" onclick="OpenVfpageConfrim()"/>
          <!--<apex:commandButton value="PR0 Presentation" action="{!docGenCommericalRequest}" id="Submit" onClick="SubmitOnClick(this);" onComplete="openWindow('{!attachmentId}')"/> --> 
			<apex:actionStatus id="mySaveStatus1">
			<apex:facet name="stop">
			<apex:commandButton value="PR0 Presentation" action="{!docGenCommericalRequest}" rerender="dummy" status="mySaveStatus1" onComplete="openWindow('{!attachmentId}')"/>
			</apex:facet>
			<apex:facet name="start">
			<apex:commandButton value="Processing..." status="mySaveStatus1" disabled="true"/>
			</apex:facet>
			</apex:actionStatus>
      	 
      	 
      	 </apex:pageBlockButtons> 
    <apex:outputPanel rendered="{! IF(listOfOpportunityScoreWrapper.size>0, true, false)}">  	 
     <table class="list" border="0" cellpadding="0" cellspacing="0">
    	<tr> <td>
    	<table class="list" border="0" cellpadding="0" cellspacing="0" width="100">
	    <tr class="headerRow">
	      <apex:repeat value="{!listOfOpportunityScoreWrapper}" var="wrapMain">
	        <th class="headerRow">
	           <span style="color: #000;font-size: 11px;font-family:verdana;font-weight: bold;">{!wrapMain.mainCatogery}</span> 
	        </th>	    	
	      </apex:repeat> 
		    </tr>  
		    
		    <tr>
		    <apex:repeat value="{!listOfOpportunityScoreWrapper}" var="wrapMain1">	     
	           <td>
	            <span style="color: #0000;font-size: 11px;font-family:verdana;font-weight: bold;">{!wrapMain1.scores}  </span> 
	           </td>       
		    </apex:repeat>     
	      </tr >
	      </table>
	     </td>
	     <td> 
	     <table class="list" border="0" cellpadding="0" cellspacing="0" width="100">
	      <tr>
	      <apex:repeat value="{!createdBy}" var="wrapMain">
	         <th class="headerRow ">
	           <span style="color: #000;font-size: 11px;font-family:verdana;font-weight: bold;">Opportunity Score</span> 
	        </th>
	        <th class="headerRow ">
	           <span style="color: #000;font-size: 11px;font-family:verdana;font-weight: bold;">Created By</span> 
	        </th>	    	
	      </apex:repeat>
	    </tr>
	       <tr>
	      <apex:repeat value="{!createdBy}" var="wrapMain">
	        <th>
	          <span style="color: #0000;font-size: 11px;font-family:verdana;font-weight: bold;">{!finalOpptyScore}</span> 
	        </th>
	        <th>
	           <span style="color: #0000;font-size: 11px;font-family:verdana;font-weight: bold;">{!createdBy} </span> 
	        </th>	    	
	      </apex:repeat>
	    </tr>
	  </table>
	  </td>
	  </tr>  	 
    </table>
    </apex:outputPanel>	 
    </apex:pageBlock> 
  	  
	<script>	
      function OpenVfpageConfrim(){
           window.open('/apex/OpportunityScorePage?opptyId={!opptyId}');
      } 
      
      function SubmitOnClick (objSubmitBtn) {
	    objSubmitBtn.disabled = true;
	  }
       
      function openWindow(att){
        
        if(att != null && att != ''){ 
         window.open('/servlet/servlet.FileDownload?file='+att+'','_blank');    
         }else{
         	alert('{!$Label.PR0_Presentation_Error_Msg}');
         }   
      }      
     </script>
     
	</apex:form>
</apex:page>