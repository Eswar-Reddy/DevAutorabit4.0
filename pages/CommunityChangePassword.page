<apex:page showHeader="false" sidebar="false" id="pg" controller="communityChangePassword" >
  
  <style type="text/css">

        //COLORS, FONTS, AND BORDERS
        .sp-blue {
            color: #0076be !important;
        }
        .sunpower-style {
            font-family: "Open Sans", sans-serif;
        }
        .sunpower-style .tabs__content-container {
            border-bottom: 1px solid #e5e5e5;
        }
        .checkImg{
            width:21px !important;
        }
        //SPACING
        .top1 {
            margin-top: 1rem;
        }
        .top2 {
            margin-top: 2rem;
        }
        .center-row {
            margin-left: auto;
            margin-right: auto;
        }
        
        //ADD-INS
        
        .subtab-styling__content-container{
            border-bottom:1px solid #e5e5e5 !important; 
        }
        .sp-orange-divider{
            border-bottom: .1rem solid !important;
            border-color: #ffdfb8 !important;
            margin-top: 1.5rem !important;
            margin-bottom: 1.5rem !important;
            margin-left: auto;
            margin-right: auto;
        }
        
        
        .sunpower-style select{
            border: 1px solid #5d5e60  !important;
            border-top-left-radius: 2px;
            border-top-right-radius: 2px;
            color:#5d5e60 !important;
            background-color:white !important;
        }
        
        .sunpower-style select:disabled{
            border: 1px solid #e5e5e5 !important;
            border-top-left-radius: 2px;
            border-top-right-radius: 2px;
            color:#e5e5e5 !important;
            background-color:white !important;
        }
        
        .sunpower-style h5{
            color:#5d5e60;
        }
        
        #sendImg img{
            width:30% !important;
        }
        
        #sendImg img[alt="Send"]{
            width:20% !important;
        }
        
        #sendImg img[alt="Out for Signature"]{
            width:65% !important;
        }
        
        #docImg img{
            width:5% !important;
            float:left;
            margin-right:5px;
        }
        
        .labelStyle{
                //font-family:sans-serif;
                font-size: 0.9rem;
                font-weight: bold;
                color:#535353;
                text-align:right;
         }
        .circle
        {
            width:35px;
            height:35px;
            border-radius:18px;
            font-size:1.2rem;
            color:#9b9b9b;
            line-height:30px;
            text-align:center;
            //background:#000;
            margin-left:auto;
            margin-right:auto;
            border:3px solid #e5e5e5;
        }
        
        //SIZING
        @media all and (max-width: 1200px) {
            .sunpower-style {
                margin-left: auto !important; 
                margin-right: auto !important;
                padding-left: 2rem !important;
                padding-right: 2rem !important;
            }
        }

        @media all and (max-width: 1024px) {
            /* styles for narrow desktop browsers and iPad landscape */
            .sunpower-style {
                margin-left: auto !important; 
                margin-right: auto !important;
                padding-left: 1rem !important;
                padding-right: 1rem !important;
            }
        }

        @media all and (max-width: 768px) {
            /* styles for narrower desktop browsers and iPad portrait */
            .sunpower-style {
                padding-left: 2rem !important;
                padding-right: 2rem !important;
                margin-left: none;
                margin-right: none;
            }
        }

        @media all and (max-width: 480px) {
            /* styles for iPhone/Android landscape (and really narrow browser windows) */
            .sunpower-style {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
                margin-left: none;
                margin-right: none;
            }
        }
    </style>
    
    <script>
        function toggleSubtabs(tabActive) {

            if( !($( '#'+tabActive ).hasClass( "subtab-styling__header-item--active" ))) {
                //remove old main subtab actives                
                $(document).find('.subtab-styling__header-item').each(function(index, header) {
                    $(header).removeClass('subtab-styling__header-item--active');
                });
                //add new subtab active
                $( '#'+tabActive ).addClass( "subtab-styling__header-item--active" );

                //remove old subtab content actives
                $(document).find('.subtab-styling__content-item').each(function(index, content) {
                    var $content = $(content);
                    $content.removeClass('subtab-styling__content-item--active');
                });

                //add new subtab content active
                $( '#'+tabActive+'Content' ).addClass( "subtab-styling__content-item--active" ) ;
            }
        }
    </script>
    <script src="/soap/ajax/10.0/connection.js"> </script >
    <script src="/soap/ajax/10.0/apex.js"> </script >
    <apex:stylesheet value="https://fonts.googleapis.com/css?family=Open+Sans:400,300,700" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" />
    <c:SPCommunityAppResources_CSS namespaceOnly="true"/>
    <apex:stylesheet value="{!$Resource.HelixRequestCustomStyles}" />
    <!--<apex:outputLabel rendered="{!IsPartner}">
        <c:CommunitiesMainNavComponent activeTab="Accounts" />
    </apex:outputLabel>-->
    
    <body class="sunpower-style container-fluid" style="max-width:1180px;">
        <!--<div id="inner-container" style="max-width: 1000px; margin-right: auto; margin-left: auto;">-->
        <apex:form id="frm">
        <apex:actionFunction name="changepass" action="{!changePassword}" />
        <div class="row">
            <div class="col-md-4"><img id="leftdiv" alt="Password Page Image" src="{!$Resource.PasswordpageImg}"/>
            </div>
            <div class="col-md-6">
                <div style="margin:30px;">
                    <div><img style="width:30%;height:20px;" alt="SunPower More Energy. For Life." src="{!$Resource.SunPower_Logo_2015}"/></div>
                    <div style="width:35%;height:20px;font-size:1em;color:#9b9b9b;">Partner Communities</div>
                </div>
                <div style="margin-left:60px;margin-top:60px;width:60%;font-size:.8rem;">
                    <h4>Reset Password</h4><br/>
                    Enter new password for email. Your password must have at least:
                    <ul>
                    <li>8 Characters</li>
                    <li>1 Number</li>
                    <li>1 Letter</li>
                    </ul>
                    <table cellspacing="0" cellpadding="0" style="width:100%;">
                    <tr><td><div id="errormsg" style="color:red;height:25px;">&nbsp;</div></td></tr>
                    <tr><td><apex:outputpanel rendered="{! !$Site.IsPasswordExpired}"><apex:inputSecret html-placeholder="Current Password" style="width:100%;height:35px;padding-left:10px;border-bottom:0px !important;border:1px solid #cccccc;" id="currpass" value="{!oldPassword}" /></apex:outputpanel></td></tr>
                    <tr><td><apex:inputSecret html-placeholder="New Password" style="width:100%;height:35px;padding-left:10px;border-top:1px solid #cccccc;border-bottom:0px;border-left:1px solid #cccccc;border-right:1px solid #cccccc;" id="newpass" value="{!newPassword}" /></td></tr>
                    <tr><td><apex:inputSecret html-placeholder="Confirm Password" style="width:100%;height:35px;padding-left:10px;border:1px solid #cccccc;" id="verifypass" value="{!verifyNewPassword}" /></td></tr>
                    </table>
                    <div style="margin-top:20px;">
                    <a class="btn btn-primary" style="width:100%;height:35px;padding-bottom:.5rem !important;padding-top:.5rem !important;" id="submitbutton" onclick="validateAndSubmit();">Submit</a>
                    </div>
                </div>
            </div>
        </div>
        
        </apex:form>
    </body>
    <script>
        window.onload = function(){
        var trgId = document.getElementById('leftdiv');
        
            trgId.style.height=window.innerHeight+'px';
               
        
        }
        
        function validateAndSubmit(){
            var submit = false;
            var msg='';
            var letterNumber = /^[0-9a-zA-Z]+$/;
            var oldpass = document.getElementById('pg:frm:currpass');
            var newpass = document.getElementById('pg:frm:newpass').value;
            var confpass = document.getElementById('pg:frm:verifypass').value;
            console.log('{!$Site.IsPasswordExpired}');
            if(!{!$Site.IsPasswordExpired}){
            
                if((oldpass != null && oldpass.value =='') || newpass=='' || confpass==''){
                    submit=false;
                    msg='Please fill required information';
                }else if(newpass.lenght<8 || !newpass.match(letterNumber)){
                    submit=false;
                    msg='Password must have atlease 8 characters, 1 number, 1 letter';
                }
                else if(newpass != confpass){
                    submit=false;
                    msg='new passwords does not match';
                }else{
                    submit=true;
                }
            }else{
            
                if(newpass=='' || confpass==''){
                    submit=false;
                    msg='Please fill required information';
                }else if(newpass.lenght<8 || !newpass.match(letterNumber)){
                    submit=false;
                    msg='Password must have atlease 8 characters, 1 number, 1 letter';
                }
                else if(newpass != confpass){
                    submit=false;
                    msg='new passwords does not match';
                }else{
                    submit=true;
                }
            }
            console.log('==='+submit);
            console.log('==='+msg);
            if(submit){
                changepass();
            }else{
                document.getElementById('errormsg').innerHTML = msg;
            }
        
        }
    </script>
    <c:SPCommunityAppResources_JS />        
            
            
  
  
</apex:page>