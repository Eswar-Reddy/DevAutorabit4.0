<apex:page renderAs="PDF" standardController="Warranty_Registration__c" extensions="GenerateWarranty_CLS" >  
           
    <!-- Stylesheets -->
    <apex:stylesheet value="{!$Resource.SP_PDFDocumentStyle1}" />
     <apex:stylesheet value="{!$Resource.WarrantyStyle}" />
    <!-- All Pages Header -->
    <c:SP_PDFHeaderFooter type="header" position="left">
    <div><apex:image url="{!$Resource.SunPowerLogo2012}" height="70px" /></div>
    </c:SP_PDFHeaderFooter>
    <c:SP_PDFHeaderFooter type="header" position="center">
        <div style="text-align:center; padding-top:10px; height:60px; width:430px; color:#FFFFFF; background-color:#F8BA16; font:42px arial,sans-serif;">Certificato di garanzia</div>
    </c:SP_PDFHeaderFooter>      
    <br/>
    <!-- First Pages Footer -->
    <c:SP_PDFHeaderFooter id="first" position="left" type="footer"  >
    <div style="font:14.5px arial,sans-serif; color:#F8BA16">MODALITÀ E TERMINI DI ESERCIZIO DELLA GARANZIA CONVENZIONALE</div>   
    <table  border="0.25" cellpadding="5" cellspacing="0" width="100%" rules="all" >
        <tr>
            <td style="border:3px solid; font:11.5px arial,sans-serif; color:#AEAEAF; line-height:113%; border-top-color:#F8BA16; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF; text-align:justify; ">
               Qualora il Cliente ritenga di avere un reclamo giustificato coperto dalla presente Garanzia Convenzionale, dovrà darne comunicazione 
               scritta entro il termine massimo di 30 giorni dalla scoperta del vizio: (i) al rivenditore o all’installatore dei Moduli Fotovoltaici, oppure 
               (ii) a qualsiasi installatore autorizzato SunPower, oppure (iii) direttamente a SunPower Italia S.r.l.  ai seguenti recapiti: via Vittime Civili 
               di Guerra 5 – fax 0546 4690              
            </td>
        </tr>
    </table>   
    <table border="0"  width="100%" rules="all"  >
            <tr><td style="border-right-color:white;"></td></tr>
            <tr>
                <td width="25%" style="font:10.5px arial,sans-serif; " >
                    <div style="width:100%; height:3px; background:#ACC957 ;"></div>
                    SunPower Italia Srl<br/>
                    Vittime Civili di Guerra 5, 48018<br/>
                    Faenza (Ravenna),Italia<br/>
                </td>
                <td style="border-top-color:white;"></td>
                <td width="25%" style="font:10.5px arial,sans-serif; " valign="top">
                    <div style="width:100%; height:3px; background:#EB7D11 ;"></div>
                    SunPower Italia Srl<br/>
                    www.sunpowercorp.it<br/>
                </td>
                <td style="border-top-color:white;"></td>
                <td width="25%" style="font:10.5px arial,sans-serif; "  >
                    <div style="width:100%; height:3px; background:#505B9F ;"></div>
                    Tél: 00800-78676937<br/>
                    (00800-SUNPOWER)<br/>
                    serviziotecnico@sunpowercorp.com<br/>
                </td>                                                        
            </tr>
        </table>                
    
    </c:SP_PDFHeaderFooter>
    

    <!-- All Pages Footer -->
    <c:SP_PDFHeaderFooter type="footer" position="left">           
        <table border="0"  width="100%" rules="all"  >
            <tr><td style="border-right-color:white;"></td></tr>
            <tr>
                <td width="25%" style="font:10.5px arial,sans-serif; " >
                    <div style="width:100%; height:3px; background:#ACC957 ;"></div>
                    SunPower Italia Srl<br/>
                    Vittime Civili di Guerra 5, 48018<br/>
                    Faenza (Ravenna),Italia<br/>
                </td>
                <td style="border-top-color:white;"></td>
                <td width="25%" style="font:10.5px arial,sans-serif; " valign="top">
                    <div style="width:100%; height:3px; background:#EB7D11 ;"></div>
                    SunPower Italia Srl<br/>
                    www.sunpowercorp.it<br/>
                </td>
                <td style="border-top-color:white;"></td>
                <td width="25%" style="font:10.5px arial,sans-serif; "  >
                    <div style="width:100%; height:3px; background:#505B9F ;"></div>
                    Tél: 00800-78676937<br/>
                    (00800-SUNPOWER)<br/>
                    serviziotecnico@sunpowercorp.com<br/>
                </td>                                                        
            </tr>
        </table>                           
    </c:SP_PDFHeaderFooter> 
     

    <div style="font:12px arial,sans-serif; color:#312F32; line-height:125%; " >
        <!--Stimato cliente,-->
        Gentile cliente,
        <br/><br/>
        <!--ci congratuliamo per il suo acquisto di un sistema solare SunPower. Siamo orgogliosi che abbia scelto SunPower per aiutarla a raggiungere l'indipendenza energetica e apprezziamo la sua scelta.-->
        La ringraziamo per l’acquisto di un impianto fotovoltaico SunPower. Siamo orgogliosi che abbia scelto il marchio SunPower per raggiungere la Sua indipendenza energetica.
        <br/><br/>
        <!--Il presente Certificato di garanzia rappresenta una prova scritta del nostro impegno a fornirle sempre la miglior esperienza globale e ci auguriamo di poter lavorare insieme a lei per molti anni.-->
        Il presente Certificato di garanzia rappresenta una prova del nostro impegno a fornirle il miglior servizio e supporto possibile e attesta che i prodotti SunPower elencati di seguito sono coperti dalla Garanzia Convenzionale Limitata SunPower a partire dalla data d’inizio della garanzia indicata nel presente Certificato.

        <br/><br/>
        <!--Il presente Certificato dichiara che i prodotti SunPower elencati di seguito sono coperti dalla Garanzia Convenzionale Limitata SunPower a partire dalla Data di inizio della garanzia, indicata nel presente Certificato. Per informazioni sulle importanti Limitazioni ed Esclusioni che caratterizzano le garanzie limitate SunPower, può consultare la sezione “Supporto” del nostro sito web www.SunPowercorp.it.-->
        Per informazioni sulle importanti Limitazioni ed Esclusioni che caratterizzano le garanzie limitate SunPower, può consultare la sezione “Supporto” del nostro sito web www.SunPowercorp.it.
        <br/><br/>
        Cordiali saluti,
        <br/>
        <apex:image url="{!$Resource.italiansignature}" height="50" width="60"/>
       <br/>Fabio Bacchin<br/>        
        Direttore Commerciale Italia
        <br/>
        SunPower Italia Srl
        <br/>
    </div>    

    <br/>
    
    <div style="font:16px arial,sans-serif; border-right-color:white; color:#F8BA16" >INFORMAZIONI SULL'IMPIANTO</div>

    <table width="100%" border="0" cellspacing="0" cellpadding="2" >
        <tr>
            <td width="35%" style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#F8BA16; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >Nome del cliente</td>
            <td style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#F8BA16; border-left-color:#F8BA16; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >
                <apex:outputText value="{!Warranty_Registration__c.Customer_SFDC_ID__r.name}" style="padding-left:10px;font:12px arial,sans-serif;border-bottom-color:#FFFFFF; "></apex:outputText>             
            </td>
        </tr>        
        <tr>
            <td width="35%" style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >Indirizzo del cliente</td>
            <td style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#F8BA16; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >
                <apex:outputText value="{!Warranty_Registration__c.Customer_SFDC_ID__r.BillingStreet}, {!Warranty_Registration__c.Customer_SFDC_ID__r.BillingCity}, {!Warranty_Registration__c.Customer_SFDC_ID__r.BillingState}, {!Warranty_Registration__c.Customer_SFDC_ID__r.BillingPostalCode}" style="padding-left:10px; font:12px arial,sans-serif;border-bottom-color:#FFFFFF; " >
                </apex:outputText>              
            </td>
        </tr>      
        <tr>
            <td width="35%" style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >Data di inizio della garanzia</td>
            <td style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#F8BA16; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >
                <apex:outputText value="{0,date,dd/MM/yyyy}" style="padding-left:10px;font:12px arial,sans-serif;border-bottom-color:#FFFFFF; " ><apex:param value="{!Warranty_Registration__c.Delivery_Date__c}" /></apex:outputText>
           </td>
        </tr>      
        <tr>
            <td width="35%" style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >Numero di registrazione della garanzia</td>
            <td style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#F8BA16; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >
                <apex:outputText value="{!Warranty_Registration__c.Warranty_Number__c}" style="padding-left:10px; font:12px arial,sans-serif;border-bottom-color:#FFFFFF; " />
            </td>
        </tr>      
        <tr>
            <td width="35%" style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#808080;" >Installatore</td>
            <td style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#F8BA16; border-right-color:#FFFFFF; border-bottom-color:#808080;" >
                <apex:outputText value="{!Warranty_Registration__c.Partner_SFDC_ID__r.Name}" style="padding-left:10px;font:12px arial,sans-serif;border-bottom-color:#FFFFFF; " />  
            </td>
        </tr> 
    </table>
    <br/>
    
   
    <table width="100%" border="0" cellspacing="0" cellpadding="2" >
         <tr><td width="100%" style="border:1px solid; font:16px arial,sans-serif; color:#F8BA16;border-top-color:#FFFFFF; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#F8BA16;" >Numeri di serie dei prodotti</td> </tr>
    </table>

    <apex:variable var="firstPageSize" value="{!20}"/>
    <apex:variable var="nextPageSize" value="{!50}"/>
    <apex:variable var="LWSize" value="{!lstWrap.size}"/>
    <apex:variable value="{!1}" var="rowNum"/>
   <!-- <table BGCOLOR="#505B9F" width="100%" border="0" cellspacing="0" cellpadding="2" >-->
   
   <apex:repeat value="{!lstWrap}" var="LW">
   <apex:outputPanel rendered="{!
        OR(rowNum=firstPageSize+1, MOD(rowNum-firstPageSize, nextPageSize)=1)}"
        style="page-break-before:always">
        <br/><br/>
        <div style="font:16px arial,sans-serif; border-right-color:white; color:#F8BA16" >INFORMAZIONI SULL'IMPIANTO</div>
        <table width="100%" border="0" cellspacing="0" cellpadding="2" >
        <tr>
            <td width="35%" style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#F8BA16; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >Nome del cliente</td>
            <td style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#F8BA16; border-left-color:#F8BA16; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >
                <apex:outputText value="{!Warranty_Registration__c.Customer_SFDC_ID__r.name}" style="padding-left:10px;font:12px arial,sans-serif;border-bottom-color:#FFFFFF; "></apex:outputText>             
            </td>
        </tr>        
        <tr>
            <td width="35%" style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >Indirizzo del cliente</td>
            <td style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#F8BA16; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >
                <apex:outputText value="{!Warranty_Registration__c.Customer_SFDC_ID__r.BillingStreet}, {!Warranty_Registration__c.Customer_SFDC_ID__r.BillingCity}, {!Warranty_Registration__c.Customer_SFDC_ID__r.BillingState}, {!Warranty_Registration__c.Customer_SFDC_ID__r.BillingPostalCode}" style="padding-left:10px; font:12px arial,sans-serif;border-bottom-color:#FFFFFF; " >
                </apex:outputText>              
            </td>
        </tr>      
        <tr>
            <td width="35%" style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >Data di inizio della garanzia</td>
            <td style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#F8BA16; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >
                <apex:outputText value="{0,date,dd/MM/yyyy}" style="padding-left:10px;font:12px arial,sans-serif;border-bottom-color:#FFFFFF; " ><apex:param value="{!Warranty_Registration__c.Delivery_Date__c}" /></apex:outputText>
           </td>
        </tr>      
        <tr>
            <td width="35%" style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >Numero di registrazione della garanzia</td>
            <td style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#F8BA16; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >
                <apex:outputText value="{!Warranty_Registration__c.Warranty_Number__c}" style="padding-left:10px; font:12px arial,sans-serif;border-bottom-color:#FFFFFF; " />
            </td>
        </tr>      
        <tr>
            <td width="35%" style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#808080;" >Installatore</td>
            <td style="padding-left:10px; border:1px solid; font:12px arial,sans-serif; border-top-color:#808080; border-left-color:#F8BA16; border-right-color:#FFFFFF; border-bottom-color:#808080;" >
                <apex:outputText value="{!Warranty_Registration__c.Partner_SFDC_ID__r.Name}" style="padding-left:10px;font:12px arial,sans-serif;border-bottom-color:#FFFFFF; " />  
            </td>
        </tr> 
    </table>

    <br/><br/>

    <table width="100%" border="0" cellspacing="0" cellpadding="2" >
         <tr><td width="100%" style="border:1px solid; font:16px arial,sans-serif; color:#F8BA16;border-top-color:#FFFFFF; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#F8BA16;" >Numeri di serie dei prodotti</td> </tr>
        </table>
    </apex:outputPanel>
   <table width="100%" class = "table1">
   <tr>
        <td style="font:10.5px arial,sans-serif;width:100px; padding-left:10px;">{!LW.Col0}</td>
        <td style="font:10.5px arial,sans-serif;width:100px; padding-left:10px;">{!LW.Col1}</td>
        <td style="font:10.5px arial,sans-serif;width:100px; padding-left:10px;">{!LW.Col2}</td>
        <td style="font:10.5px arial,sans-serif;width:100px; padding-left:10px;">{!LW.Col3}</td>
        <td style="font:10.5px arial,sans-serif;width:100px; padding-left:10px;">{!LW.Col4}</td>
   </tr>
    </table>
    <apex:outputPanel rendered="{!OR((rowNum=LWSize), MOD(rowNum-firstPageSize, nextPageSize)=0)}">
     <table width="100%" border="0" cellspacing="0" cellpadding="2" >
         <tr><td width="100%" style="border:1px solid; font:0px arial,sans-serif; color:#FFFFFF;border-top-color:#808080; border-left-color:#FFFFFF; border-right-color:#FFFFFF; border-bottom-color:#FFFFFF;" >List End</td> </tr>
     </table>  
    </apex:outputPanel>
   <apex:variable var="rowNum" value="{!rowNum + 1}"/>
   </apex:repeat>
</apex:page>